<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Color and Box Selector</title>
    <style>
        .color-box {
            width: 100px;
            height: 100px;
            margin: 10px;
            display: inline-block;
            position: relative;
            text-align: center;
            line-height: 100px;
            cursor: pointer;
            font-weight: bold;
            transition: background-color 0.3s, transform 0.3s;
        }
        .color-box:hover {
            background-color: #ddd; /* Lighten the color on hover */
            transform: scale(1.05); /* Slightly increase the size on hover */
        }
        .color-box:hover::after {
            content: 'Copy';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px;
            border-radius: 3px;
            pointer-events: none;
        }
        #generatedColors {
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <form id="colorBoxForm">
        <label for="hex">Hex Color:</label>
        <input type="text" id="hex" name="hex" required pattern="^#([A-Fa-f0-9]{6})$"><br><br>

        <label for="hue">Hue (0 to 360):</label>
        <input type="number" id="hue" name="hue" min="0" max="360" required><br><br>

        <label for="saturation">Saturation (% from -100 to +100):</label>
        <input type="number" id="saturation" name="saturation" min="-100" max="100" step="0.1" required><br><br>

        <label for="value">Value (% from -100 to +100):</label>
        <input type="number" id="value" name="value" min="-100" max="100" step="0.1" required><br><br>

        <label for="boxes">Number of Boxes:</label>
        <input type="number" id="boxes" name="boxes" min="1" required><br><br>

        <button type="submit">Submit</button>
    </form>
    <div id="boxesContainer"></div>
    <div id="generatedColors"></div>
    <script>
        function hexToHsv(hex) {
            let r = parseInt(hex.slice(1, 3), 16) / 255;
            let g = parseInt(hex.slice(3, 5), 16) / 255;
            let b = parseInt(hex.slice(5, 7), 16) / 255;
            let max = Math.max(r, g, b), min = Math.min(r, g, b);
            let h, s, v = max;
            let d = max - min;
            s = max === 0 ? 0 : d / max;
            if (max == min) {
                h = 0;
            } else {
                switch (max) {
                    case r: h = (g - b) / d + (g < b ? 6 : 0); break;
                    case g: h = (b - r) / d + 2; break;
                    case b: h = (r - g) / d + 4; break;
                }
                h /= 6;
            }
            return [h, s, v];
        }

        function hsvToHex(h, s, v) {
            let r, g, b;
            let i = Math.floor(h * 6);
            let f = h * 6 - i;
            let p = v * (1 - s);
            let q = v * (1 - f * s);
            let t = v * (1 - (1 - f) * s);
            switch (i % 6) {
                case 0: r = v, g = t, b = p; break;
                case 1: r = q, g = v, b = p; break;
                case 2: r = p, g = v, b = t; break;
                case 3: r = p, g = q, b = v; break;
                case 4: r = t, g = p, b = v; break;
                case 5: r = v, g = p, b = q; break;
            }
            return "#" + ((1 << 24) + (Math.round(r * 255) << 16) + (Math.round(g * 255) << 8) + Math.round(b * 255)).toString(16).slice(1).toUpperCase();
        }

        function adjustHsv(h, s, v, hueAdjust, satAdjust, valAdjust) {
            h = (h * 360 + hueAdjust) % 360 / 360;
            s = Math.min(Math.max(s + satAdjust / 100, 0), 1);
            v = Math.min(Math.max(v + valAdjust / 100, 0), 1);
            return [h, s, v];
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                alert('Copied to clipboard: ' + text);
            }).catch(err => {
                alert('Failed to copy: ' + err);
            });
        }

        function isBright(hex) {
            let r = parseInt(hex.slice(1, 3), 16);
            let g = parseInt(hex.slice(3, 5), 16);
            let b = parseInt(hex.slice(5, 7), 16);
            let brightness = (r * 299 + g * 587 + b * 114) / 1000;
            return brightness > 155;
        }

        document.getElementById('colorBoxForm').addEventListener('submit', function(e) {
            e.preventDefault();
            let hex = document.getElementById('hex').value;
            let hueAdjust = parseInt(document.getElementById('hue').value);
            let satAdjust = parseFloat(document.getElementById('saturation').value);
            let valAdjust = parseFloat(document.getElementById('value').value);
            let boxes = parseInt(document.getElementById('boxes').value);
            let hsv = hexToHsv(hex);
            let boxContainer = document.getElementById('boxesContainer');
            let colorList = document.getElementById('generatedColors');
            boxContainer.innerHTML = '';
            colorList.innerHTML = '';

            for (let i = 0; i < boxes; i++) {
                let newHsv = adjustHsv(hsv[0], hsv[1], hsv[2], hueAdjust * i, satAdjust * i, valAdjust * i);
                let newHex = hsvToHex(newHsv[0], newHsv[1], newHsv[2]);
                let box = document.createElement('div');
                box.className = 'color-box';
                box.style.backgroundColor = newHex;
                box.textContent = newHex;
                box.style.color = isBright(newHex) ? 'black' : 'white';
                box.addEventListener('click', () => copyToClipboard(newHex));
                boxContainer.appendChild(box);
                colorList.innerHTML += `<p>${newHex}</p>`;
            }
        });
    </script>
</body>
</html>
